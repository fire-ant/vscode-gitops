{
  // See https://go.microsoft.com/fwlink/?LinkId=733558
  // for the documentation about the tasks.json format
  "version": "2.0.0",
  "tasks": [
    {
      "label": "kind create cluster",
      "type": "shell",
      "command": "./kind/cluster_up.sh"
    },
    {
      "label": "kind delete cluster",
      "type": "shell",
      "command": "kind delete clusters ${CLUSTER_NAME}"
    },
    {
      "label": "k3d create cluster",
      "type": "shell",
      "command": "./k3d/cluster_up.sh",
    },
    {
      "label": "k3d delete cluster",
      "type": "shell",
      "command": "k3d cluster delete ${CLUSTER_NAME}"
    },
    {
      "label": "k3d install calico",
      "type": "shell",
      "command": "curl -sSL https://k3d.io/v5.3.0/usage/advanced/calico.yaml | kubectl apply -f -"
    },
    {
      "label": "k3d install cert-manager",
      "type": "shell",
      "command": "curl -sSL https://github.com/cert-manager/cert-manager/releases/download/v1.5.3/cert-manager.yaml | kubectl apply -f -"
    },
    {
      "label": "gitops enable",
      "type": "shell",
      "command": "flux check --pre; flux install --context=k3d-${CLUSTER_NAME}; kubectl get GitRepository -A -o json; kubectl get HelmRepository -A -o json; kubectl get Bucket -A -o json ;kubectl get HelmRelease -A -o json; kubectl get Kustomization -A -o json"
    },
    {
      "label": "clusterctl init",
      "type": "shell",
      "command": "clusterctl init"
    },
    {
      "label": "clusterctl CAPD",
      "type": "shell",
      "command": "clusterctl init --infrastructure docker"
    },
    {
      "label": "clusterctl CAPA",
      "type": "shell",
      "command": "clusterctl init --infrastructure aws"
    },
    {
      "label": "k3d up CAPI/CAPD",
      "type": "shell",
      "command": "kubectl get no; kubectl get po --all-namespaces",
      "runOptions": {
        "runOn": "folderOpen"
      },
      "dependsOn": [
        "k3d delete cluster",
        "k3d create cluster",
        "k3d install calico",
        "k3d install cert-manager"
      ],
      "dependsOrder": "sequence"
    },
  ]
}